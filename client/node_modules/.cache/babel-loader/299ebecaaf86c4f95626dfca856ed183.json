{"ast":null,"code":"import _regeneratorRuntime from\"/Users/aleksandarvasiljevic/github/Cosuno/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/aleksandarvasiljevic/github/Cosuno/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/aleksandarvasiljevic/github/Cosuno/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/aleksandarvasiljevic/github/Cosuno/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/aleksandarvasiljevic/github/Cosuno/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from'react';import{toast}from'react-toastify';import React from'react';import{login}from'../resources';import{Button}from'../utils/Button';import{classes,stylesheet}from'typestyle';import{INPUT_FIELD}from'../utils/constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var styles=stylesheet({loginForm:{$nest:{'& > *':{padding:'0.2rem'}}},inputField:{width:'10rem'},buttons:{display:'flex',$nest:{'& > *:first-child':{marginRight:'.5rem'}}}});export function Login(_ref){var setUser=_ref.setUser,setShowLogin=_ref.setShowLogin;var _useState=useState({email:'',password:''}),_useState2=_slicedToArray(_useState,2),_useState2$=_useState2[0],email=_useState2$.email,password=_useState2$.password,setFormData=_useState2[1];var onChange=function onChange(e){setFormData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},e.target.name,e.target.value));});};var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var response,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return login({loginData:{email:email,password:password}});case 4:response=_context.sent;localStorage.setItem('user',JSON.stringify(response.data));setUser(response.data);setShowLogin();toast('Welcome '+response.data.name,{position:'top-center',autoClose:1500,closeOnClick:true,hideProgressBar:true});_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);error=_context.t0;toast.error(error.response.data.message,{position:'top-right',autoClose:1500,closeOnClick:true,hideProgressBar:true});case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"section\",{className:\"form\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:styles.loginForm,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",name:\"email\",value:email,placeholder:\"Enter your email\",onChange:onChange,className:classes(INPUT_FIELD,styles.inputField)})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",value:password,placeholder:\"Enter password\",onChange:onChange,className:classes(INPUT_FIELD,styles.inputField)})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.buttons,children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",title:'Submit'}),/*#__PURE__*/_jsx(Button,{type:'button',onClick:function onClick(){setShowLogin();},title:'Cancel'})]})]})})});}","map":{"version":3,"names":["useState","toast","React","login","Button","classes","stylesheet","INPUT_FIELD","styles","loginForm","$nest","padding","inputField","width","buttons","display","marginRight","Login","setUser","setShowLogin","email","password","setFormData","onChange","e","prevState","target","name","value","onSubmit","preventDefault","loginData","response","localStorage","setItem","JSON","stringify","data","position","autoClose","closeOnClick","hideProgressBar","error","message"],"sources":["/Users/aleksandarvasiljevic/github/Cosuno/client/src/views/Login.tsx"],"sourcesContent":["import { useState, FormEvent } from 'react';\nimport { toast } from 'react-toastify';\nimport React from 'react';\nimport { login } from '../resources';\nimport { AxiosErrorWithMessage } from './common';\nimport { Button } from '../utils/Button';\nimport { classes, stylesheet } from 'typestyle';\nimport { INPUT_FIELD } from '../utils/constants';\n\nconst styles = stylesheet({\n    loginForm: {\n        $nest: { \n            '& > *': {\n                padding: '0.2rem',\n            },\n        },\n    },\n    inputField: {\n        width: '10rem',\n    },\n    buttons: {\n        display: 'flex',\n        $nest: {\n            '& > *:first-child': {\n                marginRight: '.5rem',\n            },\n        },\n    },\n});\n\ntype LoginProps = {\n    setUser: (user: { name: string } | null) => void;\n    setShowLogin: () => void;\n};\nexport function Login({ setUser, setShowLogin }: LoginProps) {\n    const [{ email, password }, setFormData] = useState({\n        email: '',\n        password: '',\n    });\n\n    const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setFormData((prevState) => ({\n            ...prevState,\n            [e.target.name]: e.target.value,\n        }));\n    };\n\n    const onSubmit = async (e: FormEvent) => {\n        e.preventDefault();\n        try {\n            const response = await login({ loginData: { email, password } });\n            localStorage.setItem('user', JSON.stringify(response.data));\n            setUser(response.data);\n            setShowLogin();\n            toast('Welcome ' + response.data.name, {\n                position: 'top-center',\n                autoClose: 1500,\n                closeOnClick: true,\n                hideProgressBar: true,\n            });\n        } catch (e) {\n            const error = e as AxiosErrorWithMessage;\n            toast.error(error.response.data.message, {\n                position: 'top-right',\n                autoClose: 1500,\n                closeOnClick: true,\n                hideProgressBar: true,\n            });\n        }\n    };\n\n    return (\n        <>\n            <section className=\"form\">\n                <form onSubmit={onSubmit} className={styles.loginForm}>\n                    <div className=\"form-group\">\n                        <input\n                            type=\"email\"\n                            id=\"email\"\n                            name=\"email\"\n                            value={email}\n                            placeholder=\"Enter your email\"\n                            onChange={onChange}\n                            className={classes(INPUT_FIELD, styles.inputField)}\n                        />\n                    </div>\n                    <div className=\"form-group\">\n                        <input\n                            type=\"password\"\n                            id=\"password\"\n                            name=\"password\"\n                            value={password}\n                            placeholder=\"Enter password\"\n                            onChange={onChange}\n                            className={classes(INPUT_FIELD, styles.inputField)}\n                        />\n                    </div>\n\n                    <div className={styles.buttons}>\n                        <Button type=\"submit\" title={'Submit'} />\n                        <Button\n                            type={'button'}\n                            onClick={() => {\n                                setShowLogin();\n                            }}\n                            title={'Cancel'}\n                        />\n                    </div>\n                </form>\n            </section>\n        </>\n    );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}